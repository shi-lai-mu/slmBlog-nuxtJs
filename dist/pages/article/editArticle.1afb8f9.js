(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{303:function(t,e,o){},361:function(t,e,o){"use strict";var n=o(49),l=o(50),r=(o(363),o(364)),c=o.n(r),d={name:"editor",props:["model"],data:function(){return{editorContent:""}},mounted:function(){var t=this,e=new c.a(this.$refs.editor),o=null;"send"===this.model&&(e.customConfig.menus=["italic","underline","strikeThrough","foreColor","backColor","link","quote","image","emoticon","image","table","undo","redo"]);var r,d=(r=this,function(){function t(){Object(n.a)(this,t),this.value={},this.path=r.$router.history.current.path,localStorage.getItem("editor")&&(this.value=JSON.parse(localStorage.getItem("editor"))),this.value[this.path]&&e.txt.html(this.value[this.path])}return Object(l.a)(t,[{key:"clear",value:function(){this.set(),e.txt.html("")}},{key:"set",value:function(t){this.value[this.path]=t,t||delete this.value[this.path],localStorage.setItem("editor",JSON.stringify(this.value))}}]),t}());e.customConfig.onchange=function(html){t.editorContent=html,clearTimeout(o),o=setTimeout((function(){t.Stores.set(t.editorContent)}),1500)};e.customConfig.uploadImgServer=!!this.$store.state.user&&"http://res.mczyzy.cn/file/i.php?token="+this.$store.state.user.token,e.customConfig.imgIp="/img/upload/";for(var h=[],i=1;i<21;i++)h.push({alt:"加載中...",src:"".concat("/img/emoji/").concat(i,".jpg"),style:"width: 59px"});e.customConfig.emotions=[{title:"凜音",type:"image",content:h}],e.create(),this.Stores=new d}},h=o(7),component=Object(h.a)(d,(function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"editor",staticStyle:{"text-align":"left"}})}),[],!1,null,null,null);e.a=component.exports},456:function(t,e,o){"use strict";var n=o(303);o.n(n).a},788:function(t,e,o){"use strict";o.r(e);o(78);var n=o(361),l=o(14),r=(o(132),{data:function(){return{filePath:null,uploadPath:null,webInput:!1,webPath:null,title:null,type:null,editor:!1,description:null}},mounted:function(){var t=this;t.editor=t.$route.query.editor,isNaN(t.editor)||t.$axios.get("article/editorArticle/"+t.editor,{data:{token:t.$store.state.user.token}}).then((function(e){t.$refs.editor.Stores.set(e.content),t.type=e.type,t.title=e.title,t.webPath=e.img,t.webPath&&-1===t.webPath.indexOf("//")&&(t.webPath="".concat(l.default.IP.img,"/img/upload/").concat(t.webPath)),t.description=e.description})).catch((function(e){throw t.observer.emit("toast",e),t.$router.go(-1),Error(e)}))},methods:{imgChange:function(t){this.filePath=t.target.value},upload:function(t){var e=this,o=this.$refs.uploadFile.files[0];if(o){var image=new FormData;image.append("file",o),this.$axios.post("https://io.slmblog.com/i.php?token="+this.$store.state.user.token,image,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){t.data?t.data[0]&&(e.uploadPath=t.data[0],e.webPath=null):console.log(t)}))}},send:function(){var t=this;t.editor=t.$route.query.editor;var content=t.$refs.editor.editorContent,e=!t.title||t.title.length<4?"标题不能为空或过短!":!t.type||t.type.split("#").length<1?"至少一个分类!":content.length<10&&"这么点字...水军吧!!!";if(e)t.observer.emit("toast",{text:e,icon:"wrong",time:4e3});else{var o=t.$store.state.user,n=isNaN(t.editor)?"ARTICLE_ADD":"ARTICLE_UNEDITOR";t.$axios.api(n).post({token:o.token,title:t.title,type:t.type,content:content,uid:o.id,img:t.webPath||t.uploadPath,description:t.description,editor:t.editor||!1}).then((function(e){e.ID&&(t.$router.push({name:"article-id",params:{id:e.ID}}),t.$refs.editor.Stores.clear())}))}}},components:{Editor:n.a}}),c=(o(456),o(7)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"conter single clearfix"},[o("div",{staticClass:"content-box addArticle"},[o("ul",{staticClass:"form"},[o("li",[o("label",[t._v("标题")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),t._v(" "),o("span",{staticClass:"bust"},[t._v("*")])]),t._v(" "),o("li",[o("label",[t._v("分类")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],attrs:{type:"text",placeholder:"#隔开"},domProps:{value:t.type},on:{input:function(e){e.target.composing||(t.type=e.target.value)}}}),t._v(" "),o("span",{staticClass:"bust"},[t._v("*")])]),t._v(" "),o("li",[o("label",[t._v("简介")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],attrs:{type:"text",placeholder:"简短的介绍文章内容"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),t._v(" "),o("span",{staticClass:"bust"},[t._v("*")])]),t._v(" "),o("li",[o("input",{ref:"uploadFile",staticStyle:{display:"none"},attrs:{type:"file",id:"upload_file",accept:"image/gif,image/jpeg,image/jpg,image/png"},on:{change:t.imgChange}}),t._v(" "),t.webInput?t._e():o("button",{staticClass:"button-lv1 upload_file",attrs:{onclick:"upload_file.click()"}},[t._v(t._s(t.filePath?"重新选择":"上传本地封面"))]),t._v(" "),t.filePath?t._e():o("button",{staticClass:"button-lv1 upload_file",on:{click:function(e){t.webInput=!t.webInput}}},[t._v(t._s(t.webInput?"重新选择方式":"网络调用封面"))]),t._v(" "),t.webInput?o("input",{directives:[{name:"model",rawName:"v-model",value:t.webPath,expression:"webPath"}],attrs:{type:"text",placeholder:"完整图片的路径 如 http://xxxxx/xxxxx/xx.jpg"},domProps:{value:t.webPath},on:{input:function(e){e.target.composing||(t.webPath=e.target.value)}}}):t._e(),t._v(" "),o("span",{class:["file-path",{"file-path-max":t.filePath}],domProps:{textContent:t._s(t.filePath)}}),t._v(" "),t.filePath&&!t.uploadPath?o("button",{staticClass:"button-lv1 upload_file",on:{click:t.upload}},[t._v("确认上传")]):t._e(),t._v(" "),t.filePath||t.webPath?o("div",{staticClass:"img-look-box"},[o("span",{staticClass:"look"},[t._v("预览区域")]),t._v(" "),t.uploadPath||t.webPath?o("img",{attrs:{src:t.webPath||"//slmblog.com/img/upload/"+t.uploadPath}}):o("span",{staticClass:"look-info"},[t._v("等待 确认上传 ...")])]):t._e()])]),t._v(" "),o("label",{staticClass:"content-title"},[t._v("文章内容")]),t._v(" "),o("Editor",{ref:"editor"}),t._v(" "),o("button",{staticClass:"button-lv0 button-lv1 send",on:{click:t.send}},[t._v(t._s(t.editor?"保存":"发表"))])],1)])}),[],!1,null,null,null);e.default=component.exports}}]);